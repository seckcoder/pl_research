based on letrec-multi-declare
